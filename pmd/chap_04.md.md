
# Κεφ 4: Υλοποίηση συστήματος προανάκτησης

Στο κεφάλαιο αυτά περιγράφεται συνοπτικά η αρχιτεκτονική του συστήματος, καθώς και οι στόχοι και περιορισμοί που τέθηκαν για την υλοποίησή του.

## Σκοπός και περιορισμοί

Όπως περιγράφηκαι στο προηγούμενο κεφάλαιο, η διαδικασία του συγχρονισμού στον client *erigon* διεκπεραιώνεται σε διακριτά στάδια.
Μιας και το στάδιο εκτέλεσης των συναλλαγών (*Execution stage*) διαρκεί για τον περισσότερο χρόνο της συνολικής διαδικασίας,
η συγκεκριμένη εργασία περιορίστηκε στην επιτάχυνση αυτού του σταδίου και μόνο.
Επομένως, κάθε επιλογή που εξετάζεται αναφέρεται στο συγκεκριμένο στάδιο και τα αποτελέσματα που αναφέρονται στα υπόλοιπα κεφάλαια,
αγνοούν το χρόνο εκτέλεσης των υπόλοιπων σταδίων, κάποια εκ των οποίων (πχ μεταφόρτωσης του blockchain - *Downloading stage*)
θα ήταν ανώφελο να μετρηθούν μιας και εξαρτώνται από συνθήκες δικτύου που ? vary widely ? χρονικά και γεωγραφικά.

Ο σκοπός της εργασίας είναι η βελτίωση της ταχύτητας αυτού του σταδίου με την παράλληλη προανάκτηση προβλεπόμενων εγγραφών από τη βάση δεδομένων.
Το σύστημα περιορίζεται σε κοινό και εμπορικά διαθέσιμο υλισμικό (*hardware*).
Επίσης, για να διασφαλιστεί η ασφάλεια της διαδικασίας εκτέλεσης των contract, λόγω της ? high stakes ? φύσης της, οι ενέργειες της προανάκτησης
δεν θα πρέπει να καθορίζουν τα δεδομένα που χρησιμοποιούνται και αποθηκεύονται στο *Wolrd State*.
Έτσι, τυγχών σφάλματα (bugs) ή αδυναμίες (vulnerabilities) σε αυτό το κομμάτι δεν θα threat to compromise την ασφάλεια ολόκληρου του συστήματος,
και η εκτέλεση θα μπορεί σε κάθε περίπτωση να προχωρά κανονικά, πιθανών επιρρεασμένη μόνο ως προς το χρόνο εκτέλεσης.
Σε καμία περίπτωση δεν θα πρέπει το κομμάτι της προανάκτησης να έχει τη δυνατότητα να τροποποιήσει δεδομένα του *World State*.
Αυτό περιορίζει τη δυνατότητα προ-επεξεργασίας δεδομένων που θα μπορούσε να αποφέρει καλύτερες επιδόσεις
αλλά θα έκανε πιο πολύπλοκη τη λογική του κρίσιμου σταδίου της εκτέλεσης που θα δημιουργούσε περισσότερες θέσεις για πιθανά σφάλματα.
Μοναδική εξέραιση στα παραπάνω θα αποτελέση η προανάκτηση των block η οποία όμως γίνεται ντετερμινιστικά και χωρίς αλλαγές από τον αρχικό κώδικα,
παραμόνο η τοποθέτησή της σε ξεχωριστό νήμα (thread).

Τέλος, σε πιθανή κρίσημη αποτυχία και διακοπή της διαδικασίας προανάκτησης, η κύρια εκτέλεση του client θα συνεχίζεται σαν να μην υπήρχε εξ'αρχής.

## Υψηλού επιπέδου περιγραφή

Η εργασία αποτελείται από 3 συνολικά κομμάτια που θα εξεταστούν παρακάτω:
- Iχνογράφηση (Tracing):     Συλλογή μετρικών και κώδικα των contracts
- Ανάλυση     (Analysis):    Ανάλυση των contracts που συλλέχθηκαν στην ιχνογράφηση και σύνθεση των ? προβλεπτών ? (*predictors*)
- Προανάκτηση (Prefetching): Προανάκτηση και υποθετική εκτέλεση των *predictors* που δημιουργήθηκαν στην ανάλυση

Τα κομμάτια της ιχνογράφησης και ανάλυσης στις δοκιμές του επόμενου κεφαλαίου εκτελούνται ξεχωριστά, για λόγους απλότητας,
αλλά σε μια πραγματική υλοποίηση αναμένουμε να τρέχουν ταυτόχρονα, παράλληλα με την κύρια εκτέλεση.


\begin{figure}[!htbp]
  \centering
  \includesvg[inkscapelatex=false,width=\textwidth]{../main/Overview.svg}
  \caption{Υψηλού επιπέδου όψη του συστήματος.}
\end{figure}


ΣΥΝΤΟΜΗ περιγραφη, κανείς δε θα διαβάσει το κεφ 5
